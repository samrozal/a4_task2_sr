---
title: "esm206_a4_task2"
author: "Sam Rozal"
date: "11/6/2021"
output: html_document
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
#attach packages 
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(effsize)
library(kableExtra)
```

```{r, include=FALSE}
#read in the data 
hares <- read_csv(here("data", "bonanza_hares.csv"))
```

# 1. Introduction 
words and stuff 

```{r, include=FALSE}
hares_date <- hares %>% #create new df from  hares
  mutate(date_new = mdy(date)) %>% #use lubridate to create new colum with code-friendly data
  mutate(year = year(date_new)) #create year column using year() function 
```

```{r, include=FALSE}
juvenile_hares_date <-hares_date %>% #create new data frame from hares_date
  filter(age == "j") #filter for just juvinile hares
```


```{r, include=FALSE}
hares_summary <- juvenile_hares_date %>%  #create new df from hares_date
  group_by(year) %>% # group by year
  summarize(count=n()) #get count totals 
hares_summary
```

```{r}
#Annual juvenile hare counts 
ggplot(data=hares_summary, aes(x=year, y=count)) +
  geom_col(fill="purple")+ #create graph using geom_col
  theme_classic() +
  scale_x_continuous(breaks= seq(from=1998, to=2012, by=1)) + #makes it so that all years are shown 
  labs(x= "Year",
       y= "Juvenile Hare Count (n)", 
       title = "Number of Juvenile Hares by Year") #add labels
  
```

Figure 1. ____add captions later___

```{r}
hares_summary_statistics <- hares_summary %>% 
  summarize(median= median(count),
            mean= mean(count))

hares_summary_statistics
```

# Visualize juvinile hare weights 

```{r}
juvenile_hares_mean_weight <- juvenile_hares_date %>% 
  group_by(sex,grid) %>% 
  summarize(mean_weight= mean(weight, na.rm=TRUE))
```

```{r, include=FALSE}
ggplot(data=juvenile_hares_mean_weight, aes(x=grid, y=mean_weight, fill=sex)) +
  geom_col(position="dodge") 
```

```{r, include=FALSE}
ggplot(data=juvenile_hares_date, aes(x=grid, y=weight))+
  geom_point() +
  facet_wrap(~sex)
```

```{r}
#Juvenile hare weights-final graph 
ggplot(data=juvenile_hares_date, aes(x=sex, y=weight))+
  geom_boxplot(aes(fill=sex)) +
  facet_wrap(~grid)
```
# Juvenile Weight comparison (male and female snowshoe Hares)

```{r}
juvenile_hares_weight <- juvenile_hares_date %>% #create a new data frame
  group_by(sex) %>%  #group by sex
  summarize(mean_hare_weight= round(mean(weight,na.rm=TRUE), 2),
            sd_hare_weight= round(sd(weight, na.rm=TRUE), 2), 
            hare_sample_size= n())#generate summary statistics
juvenile_hares_weight# return df

```

```{r} 
#Awesomely styled chart of juvenile weight comparison 
kable(juvenile_hares_weight, col.names= c("Sex", 
                                          "Mean Hare Weight (g)",
                                          "Dtandard Deviation(g)",
                                          "Sample Size (n)")) %>% 
  kable_styling()
```


```{r}
#find difference of means
juvenile_hares_weight$mean_hare_weight[2] - juvenile_hares_weight$mean_hare_weight[1]

```

```{r}
ggplot(data=juvenile_hares_date, aes(sample=weight)) +
  geom_qq()+
  geom_qq_line()
```
```{r}
ggplot(data=juvenile_hares_date, aes(x=weight)) + #load data into ggplot
  geom_histogram()+ #create histogram
  facet_wrap(~sex) #wrap by sex
```

```{r}
#create a vector with just female juvenile hares from the juvenile_hares_date df
juvenile_hares_female <- juvenile_hares_date %>% 
  filter(sex=="f", weight != "NA") %>%
  pull(weight)

#create a vector with just male juvenile hares from the juvenile_hares_date df
juvenile_hares_male <- juvenile_hares_date %>% 
  filter(sex=="m", weight !="NA") %>% 
  pull(weight)
  
```


```{r}
juvenile_hares_t <- t.test(juvenile_hares_female,juvenile_hares_male) #run t.test
juvenile_hares_t #return t.test results
```

```{r}
juvenile_hares_cohens <- cohen.d(juvenile_hares_male,juvenile_hares_female)
juvenile_hares_cohens
```

# Relationship Between juvenile weight and hind foot length

```{r}
ggplot(data=juvenile_hares_date, aes(x=hindft, y=weight))+
  geom_point() +
  theme_classic() +
  labs(x= "Hind Foot Length (mm)",
       y= "Weight (g)", 
       title= "Juvenile Hare Hind Foot Length vs. Weight")
```

```{r}
#perform an linear regression analysis
juvenile_hares_lm <- lm(weight ~ hindft, data=juvenile_hares_date) #stored linear model as juvenile_hares_lm

summary(juvenile_hares_lm) #return the complete overview

juvenile_hares_lm_summary <- broom::tidy(juvenile_hares_lm)
juvenile_hares_lm_summary

plot(juvenile_hares_lm)
```

slope is `r round(juvenile_hares_lm_summary$estimate[2], 2)`
intercept is `r round(juvenile_hares_lm_summary$estimate[1], 2)`
A simple regression model was found  to be : weight = `r round(juvenile_hares_lm_summary$estimate[2], 2)` * (hind foot length) + `r round(juvenile_hares_lm_summary$estimate[1], 2)`